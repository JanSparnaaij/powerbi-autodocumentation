# Data Sources

## Power Query / M Code

The following Power Query code defines the data sources and transformations for this model:

```powerquery
{'query': '[\n  {\n    "TableName": "Geo",\n    "Expression": "let\\n  Source = Table.NestedJoin(#\\"Cities\\", {\\"StateProvinceID\\"}, States, {\\"StateProvinceID\\"}, \\"States\\", JoinKind.Inner),\\n  #\\"Expanded States\\" = Table.ExpandTableColumn(Source, \\"States\\", {\\"StateProvinceID\\", \\"StateProvinceCode\\", \\"StateProvinceName\\", \\"CountryID\\", \\"SalesTerritory\\"}, {\\"StateProvinceID.1\\", \\"StateProvinceCode\\", \\"StateProvinceName\\", \\"CountryID\\", \\"SalesTerritory\\"}),\\n    #\\"Removed Columns\\" = Table.RemoveColumns(#\\"Expanded States\\",{\\"StateProvinceID.1\\"}),\\n  #\\"Merged queries\\" = Table.NestedJoin(#\\"Removed Columns\\", {\\"CountryID\\"}, #\\"Countries\\", {\\"CountryID\\"}, \\"Countries\\", JoinKind.Inner),\\n  #\\"Expanded Countries\\" = Table.ExpandTableColumn(#\\"Merged queries\\", \\"Countries\\", {\\"CountryName\\", \\"FormalName\\", \\"IsoAlpha3Code\\", \\"IsoNumericCode\\", \\"CountryType\\", \\"Continent\\", \\"Region\\", \\"Subregion\\"}, {\\"CountryName\\", \\"FormalName\\", \\"IsoAlpha3Code\\", \\"IsoNumericCode\\", \\"CountryType\\", \\"Continent\\", \\"Region\\", \\"Subregion\\"}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Expanded Countries\\",{\\"CityID\\", \\"CityName\\", \\"LatestRecordedPopulation\\", \\"StateProvinceCode\\", \\"StateProvinceName\\", \\"SalesTerritory\\", \\"CountryName\\", \\"FormalName\\", \\"IsoAlpha3Code\\", \\"IsoNumericCode\\", \\"CountryType\\", \\"Continent\\", \\"Region\\", \\"Subregion\\"})\\nin\\n    #\\"Removed Other Columns\\""\n  },\n  {\n    "TableName": "Product",\n    "Expression": "let\\n  Source = #\\"ADLS Base Folder\\",\\n    #\\"Filtered Rows\\" = Table.SelectRows(Source, each Text.Contains([Folder Path], \\"Warehouse.StockItems\\")),\\n    #\\"https://stvnextblobstorage dfs core windows net/fabrikam-sales/Delta-Parquet-Format/Warehouse StockItems/_0-3cb21e23-d47d-472a-bf7c-918c32fbfee6-0 parquet\\" = #\\"Filtered Rows\\"{[#\\"Folder Path\\"=\\"https://stvnextblobstorage.dfs.core.windows.net/fabrikam-sales/Delta-Parquet-Format-FY25/Warehouse.StockItems/\\",Name=\\"0-3cb21e23-d47d-472a-bf7c-918c32fbfee6-0.parquet\\"]}[Content],\\n    #\\"Imported Parquet\\" = Parquet.Document(#\\"https://stvnextblobstorage dfs core windows net/fabrikam-sales/Delta-Parquet-Format/Warehouse StockItems/_0-3cb21e23-d47d-472a-bf7c-918c32fbfee6-0 parquet\\"),\\n  #\\"Changed column type\\" = Table.TransformColumnTypes(#\\"Imported Parquet\\", {{\\"StockItemID\\", Int64.Type}, {\\"StockItemName\\", type text}, {\\"SupplierID\\", Int64.Type}, {\\"ColorID\\", Int64.Type}, {\\"UnitPackageID\\", Int64.Type}, {\\"OuterPackageID\\", Int64.Type}, {\\"Brand\\", type text}, {\\"Size\\", type text}, {\\"LeadTimeDays\\", Int64.Type}, {\\"QuantityPerOuter\\", Int64.Type}, {\\"IsChillerStock\\", type logical}, {\\"Barcode\\", type text}, {\\"TaxRate\\", Int64.Type}, {\\"UnitPrice\\", type number}, {\\"RecommendedRetailPrice\\", type number}, {\\"TypicalWeightPerUnit\\", type number}, {\\"MarketingComments\\", type text}, {\\"SearchDetails\\", type text}, {\\"LastEditedBy\\", Int64.Type}}),\\n    #\\"Merged Queries\\" = Table.NestedJoin(#\\"Changed column type\\", {\\"StockItemID\\"}, ProductItemGroup, {\\"StockItemID\\"}, \\"Product Item Group\\", JoinKind.LeftOuter),\\n    #\\"Expanded Product Item Group\\" = Table.ExpandTableColumn(#\\"Merged Queries\\", \\"Product Item Group\\", {\\"StockGroupID\\"}, {\\"StockGroupID\\"}),\\n    #\\"Merged Queries1\\" = Table.NestedJoin(#\\"Expanded Product Item Group\\", {\\"StockGroupID\\"}, ProductGroups, {\\"StockGroupID\\"}, \\"Product Groups\\", JoinKind.LeftOuter),\\n    #\\"Expanded Product Groups\\" = Table.ExpandTableColumn(#\\"Merged Queries1\\", \\"Product Groups\\", {\\"StockGroupName\\"}, {\\"StockGroupName\\"}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Expanded Product Groups\\",{\\"StockItemID\\", \\"StockItemName\\", \\"SupplierID\\", \\"Size\\", \\"IsChillerStock\\", \\"TaxRate\\", \\"UnitPrice\\", \\"RecommendedRetailPrice\\", \\"TypicalWeightPerUnit\\", \\"StockGroupID\\", \\"StockGroupName\\"})\\nin\\n    #\\"Removed Other Columns\\""\n  },\n  {\n    "TableName": "Sales",\n    "Expression": "let\\n  Source = Table.NestedJoin(InvoiceLineItems, {\\"InvoiceID\\"}, Invoices, {\\"InvoiceID\\"}, \\"Invoices\\", JoinKind.Inner),\\n  #\\"Expanded Invoice\\" = Table.ExpandTableColumn(Source, \\"Invoices\\", {\\"CustomerID\\", \\"BillToCustomerID\\", \\"SalespersonPersonID\\", \\"InvoiceDate\\"}, {\\"CustomerID\\", \\"BillToCustomerID\\", \\"SalespersonPersonID\\", \\"InvoiceDate\\"}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Expanded Invoice\\",{\\"InvoiceLineID\\", \\"InvoiceID\\", \\"StockItemID\\", \\"Quantity\\", \\"UnitPrice\\", \\"TaxRate\\", \\"TaxAmount\\", \\"LineProfit\\", \\"ExtendedPrice\\", \\"CustomerID\\", \\"SalespersonPersonID\\", \\"InvoiceDate\\"}),\\n    #\\"Renamed Columns\\" = Table.RenameColumns(#\\"Removed Other Columns\\",{{\\"CustomerID\\", \\"ResellerID\\"}}),\\n    #\\"Merged Queries\\" = Table.NestedJoin(#\\"Renamed Columns\\", {\\"ResellerID\\"}, Reseller, {\\"ResellerID\\"}, \\"Customer\\", JoinKind.Inner),\\n    #\\"Added Custom\\" = Table.AddColumn(#\\"Merged Queries\\", \\"Sales Amount\\", each [ExtendedPrice] - [TaxAmount]),\\n    #\\"Changed Type\\" = Table.TransformColumnTypes(#\\"Added Custom\\",{{\\"Sales Amount\\", type number}}),\\n    #\\"Removed Columns\\" = Table.RemoveColumns(#\\"Changed Type\\",{\\"Customer\\"})\\nin\\n    #\\"Removed Columns\\""\n  },\n  {\n    "TableName": "Reseller",\n    "Expression": "let\\n    Source = #\\"ADLS Base Folder\\",\\n    #\\"Filtered Rows\\" = Table.SelectRows(Source, each Text.Contains([Folder Path], \\"Sales.Customers\\")),\\n    #\\"https://stvnextblobstorage dfs core windows net/fabrikam-sales/Delta-Parquet-Format/Sales Customers/_0-a021ff4b-dc2e-4102-8762-493c47373833-0 parquet\\" = #\\"Filtered Rows\\"{[#\\"Folder Path\\"=\\"https://stvnextblobstorage.dfs.core.windows.net/fabrikam-sales/Delta-Parquet-Format-FY25/Sales.Customers/\\",Name=\\"0-f46fcf7b-0f8c-4890-ad56-c4317df64e0e-0.parquet\\"]}[Content],\\n    #\\"Imported Parquet\\" = Parquet.Document(#\\"https://stvnextblobstorage dfs core windows net/fabrikam-sales/Delta-Parquet-Format/Sales Customers/_0-a021ff4b-dc2e-4102-8762-493c47373833-0 parquet\\"),\\n    #\\"Merged Queries\\" = Table.NestedJoin(#\\"Imported Parquet\\", {\\"BuyingGroupID\\"}, BuyingGroups, {\\"BuyingGroupID\\"}, \\"BuyingGroup\\", JoinKind.Inner),\\n    #\\"Expanded BuyingGroup\\" = Table.ExpandTableColumn(#\\"Merged Queries\\", \\"BuyingGroup\\", {\\"BuyingGroupName\\"}, {\\"BuyingGroupName\\"}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Expanded BuyingGroup\\",{\\"ResellerID\\", \\"ResellerName\\", \\"PostalCityID\\", \\"PhoneNumber\\", \\"FaxNumber\\", \\"WebsiteURL\\", \\"DeliveryAddressLine1\\", \\"DeliveryAddressLine2\\", \\"DeliveryPostalCode\\", \\"PostalAddressLine1\\", \\"PostalAddressLine2\\", \\"PostalPostalCode\\", \\"BuyingGroupName\\"}),\\n    #\\"Renamed Columns\\" = Table.RenameColumns(#\\"Removed Other Columns\\",{{\\"BuyingGroupName\\", \\"ResellerCompany\\"}, {\\"ResellerName\\", \\"ResellerName\\"}})\\nin\\n    #\\"Renamed Columns\\""\n  },\n  {\n    "TableName": "Supplier",\n    "Expression": "let\\n  Source = Table.NestedJoin(Suppliers, {\\"SupplierCategoryID\\"}, SupplierCategories, {\\"SupplierCategoryID\\"}, \\"STG_SUPPLIER_CATEGORIES\\", JoinKind.LeftOuter),\\n  #\\"Expanded STG_SUPPLIER_CATEGORIES\\" = Table.ExpandTableColumn(Source, \\"STG_SUPPLIER_CATEGORIES\\", {\\"SupplierCategoryName\\"}, {\\"SupplierCategoryName\\"}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Expanded STG_SUPPLIER_CATEGORIES\\",{\\"SupplierID\\", \\"SupplierName\\", \\"SupplierCategoryID\\", \\"WebsiteURL\\", \\"SupplierCategoryName\\"}),\\n    #\\"Changed Type\\" = Table.TransformColumnTypes(#\\"Removed Other Columns\\",{{\\"SupplierID\\", Int64.Type}})\\nin\\n    #\\"Changed Type\\""\n  },\n  {\n    "TableName": "People",\n    "Expression": "let\\n    Source = SharePoint.Files(\\"https://faiad2024.sharepoint.com/sites/Fabrikam_HR\\", [ApiVersion = 15]),\\n    #\\"dim_People xlsx_https://faiad2024 sharepoint com/sites/Fabrikam_HR/Shared Documents/General/\\" = Source{[Name=\\"dim_People.xlsx\\",#\\"Folder Path\\"=\\"https://faiad2024.sharepoint.com/sites/Fabrikam_HR/Shared Documents/General/\\"]}[Content],\\n    #\\"Imported Excel Workbook\\" = Excel.Workbook(#\\"dim_People xlsx_https://faiad2024 sharepoint com/sites/Fabrikam_HR/Shared Documents/General/\\"),\\n    #\\"Expanded Data\\" = Table.ExpandTableColumn(#\\"Imported Excel Workbook\\", \\"Data\\", {\\"Column1\\", \\"Column2\\", \\"Column3\\", \\"Column4\\", \\"Column5\\", \\"Column6\\", \\"Column7\\", \\"Column8\\", \\"Column9\\", \\"Column10\\", \\"Column11\\", \\"Column12\\", \\"Column13\\", \\"Column14\\", \\"Column15\\", \\"Column16\\", \\"Column17\\", \\"Column18\\"}, {\\"Data.Column1\\", \\"Data.Column2\\", \\"Data.Column3\\", \\"Data.Column4\\", \\"Data.Column5\\", \\"Data.Column6\\", \\"Data.Column7\\", \\"Data.Column8\\", \\"Data.Column9\\", \\"Data.Column10\\", \\"Data.Column11\\", \\"Data.Column12\\", \\"Data.Column13\\", \\"Data.Column14\\", \\"Data.Column15\\", \\"Data.Column16\\", \\"Data.Column17\\", \\"Data.Column18\\"}),\\n    #\\"Removed Columns\\" = Table.RemoveColumns(#\\"Expanded Data\\",{\\"Name\\"}),\\n    #\\"Promoted Headers\\" = Table.PromoteHeaders(#\\"Removed Columns\\", [PromoteAllScalars=true]),\\n  #\\"Changed column type\\" = Table.TransformColumnTypes(#\\"Promoted Headers\\", {{\\"PersonID\\", Int64.Type}, {\\"FullName\\", type text}, {\\"PreferredName\\", type text}, {\\"SearchName\\", type text}, {\\"IsPermittedToLogon\\", type logical}, {\\"LogonName\\", type text}, {\\"IsExternalLogonProvider\\", type logical}, {\\"IsSystemUser\\", type logical}, {\\"IsSalesperson\\", type logical}, {\\"UserPreferences\\", type text}, {\\"PhoneNumber\\", type text}, {\\"FaxNumber\\", type text}, {\\"EmailAddress\\", type text}, {\\"CustomFields\\", type text}, {\\"OtherLanguages\\", type text}, {\\"LastEditedBy\\", Int64.Type}, {\\"ValidFrom\\", type datetime}, {\\"ValidTo\\", type datetime}}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Changed column type\\",{\\"PersonID\\", \\"FullName\\", \\"PreferredName\\", \\"IsSalesperson\\", \\"EmailAddress\\"})\\nin\\n    #\\"Removed Other Columns\\""\n  },\n  {\n    "TableName": "Customer",\n    "Expression": "let\\n    Source = Table.Combine({BabyBoomer, GenX, GenY, GenZ}),\\n    #\\"Renamed Columns\\" = Table.RenameColumns(Source,{{\\"cre88_id\\", \\"id\\"}, {\\"cr5f7_customerid\\", \\"CustomerID\\"}, {\\"cr5f7_address\\", \\"Address\\"}, {\\"cr5f7_age\\", \\"Age\\"}, {\\"cr5f7_brandaffinity\\", \\"BrandAffinity\\"}, {\\"cr5f7_city\\", \\"City\\"}, {\\"cr5f7_country\\", \\"Country\\"}, {\\"cr5f7_fullname\\", \\"FullName\\"}, {\\"cr5f7_generation\\", \\"Generation\\"}, {\\"cr5f7_interestaffinity1\\", \\"InterestAffinity1\\"}, {\\"cr5f7_interestaffinity2\\", \\"InterestAffinity2\\"}, {\\"cr5f7_merchantid\\", \\"MerchantID\\"}, {\\"cr5f7_merchantzipcode\\", \\"Merchantzipcode\\"}, {\\"cr5f7_resellerid\\", \\"ResellerID\\"}, {\\"cr5f7_state\\", \\"State\\"}, {\\"cr5f7_zipcode\\", \\"ZipCode\\"}}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Renamed Columns\\",{\\"CustomerID\\", \\"Address\\", \\"Age\\", \\"BrandAffinity\\", \\"City\\", \\"Country\\", \\"FullName\\", \\"Generation\\", \\"InterestAffinity1\\", \\"InterestAffinity2\\", \\"ResellerID\\", \\"State\\", \\"ZipCode\\"}),\\n    #\\"Changed Type\\" = Table.TransformColumnTypes(#\\"Removed Other Columns\\",{{\\"ResellerID\\", Int64.Type}})\\nin\\n    #\\"Changed Type\\""\n  },\n  {\n    "TableName": "PurchaseOrders",\n    "Expression": "let\\n    Source = Snowflake.Databases(\\"dlhdzca-bab11165.snowflakecomputing.com\\",\\"READONLY\\"),\\n    FABRIKAM_SUPPLIERS_Database = Source{[Name=\\"FABRIKAM_SUPPLIERS\\",Kind=\\"Database\\"]}[Data],\\n    PUBLIC_Schema = FABRIKAM_SUPPLIERS_Database{[Name=\\"PUBLIC\\",Kind=\\"Schema\\"]}[Data],\\n    ORDERS_Table = PUBLIC_Schema{[Name=\\"ORDERS\\",Kind=\\"Table\\"]}[Data],\\n    #\\"Merged Queries\\" = Table.NestedJoin(ORDERS_Table, {\\"PurchaseOrderID\\"}, POLineItems, {\\"PurchaseOrderID\\"}, \\"PO Line Items\\", JoinKind.Inner),\\n    #\\"Expanded PO Line Items\\" = Table.ExpandTableColumn(#\\"Merged Queries\\", \\"PO Line Items\\", {\\"PurchaseOrderLineID\\", \\"StockItemID\\", \\"OrderedOuters\\", \\"ReceivedOuters\\", \\"ExpectedUnitPricePerOuter\\"}, {\\"PurchaseOrderLineID\\", \\"StockItemID\\", \\"OrderedOuters\\", \\"ReceivedOuters\\", \\"ExpectedUnitPricePerOuter\\"}),\\n    #\\"Changed Type\\" = Table.TransformColumnTypes(#\\"Expanded PO Line Items\\",{{\\"ContactPersonID\\", Int64.Type}, {\\"SupplierID\\", Int64.Type}, {\\"PurchaseOrderID\\", Int64.Type}, {\\"PurchaseOrderLineID\\", Int64.Type}, {\\"StockItemID\\", Int64.Type}}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Changed Type\\",{\\"PurchaseOrderID\\", \\"OrderDate\\", \\"ContactPersonID\\", \\"ExpectedDeliveryDate\\", \\"PurchaseOrderLineID\\", \\"StockItemID\\", \\"OrderedOuters\\", \\"ExpectedUnitPricePerOuter\\"})\\nin\\n    #\\"Removed Other Columns\\""\n  },\n  {\n    "TableName": "Date",\n    "Expression": "let\\n  Source = #\\"ADLS Base Folder\\",\\n    #\\"Filtered Rows\\" = Table.SelectRows(Source, each Text.Contains([Folder Path], \\"DateDim\\")),\\n    #\\"Filtered Hidden Files1\\" = Table.SelectRows(#\\"Filtered Rows\\", each [Attributes]?[Hidden]? <> true),\\n    #\\"Invoke Custom Function1\\" = Table.AddColumn(#\\"Filtered Hidden Files1\\", \\"Transform File (2)\\", each #\\"Transform File (2)\\"([Content])),\\n    #\\"Renamed Columns1\\" = Table.RenameColumns(#\\"Invoke Custom Function1\\", {\\"Name\\", \\"Source.Name\\"}),\\n    #\\"Removed Other Columns1\\" = Table.SelectColumns(#\\"Renamed Columns1\\", {\\"Source.Name\\", \\"Transform File (2)\\"}),\\n    #\\"Expanded Table Column1\\" = Table.ExpandTableColumn(#\\"Removed Other Columns1\\", \\"Transform File (2)\\", Table.ColumnNames(#\\"Transform File (2)\\"(#\\"Sample File (2)\\"))),\\n    #\\"Changed Type\\" = Table.TransformColumnTypes(#\\"Expanded Table Column1\\",{{\\"Source.Name\\", type text}, {\\"Date\\", type date}, {\\"Year\\", Int64.Type}, {\\"Month\\", Int64.Type}, {\\"Quarter\\", Int64.Type}, {\\"MonthName\\", type text}, {\\"MonthNameShort\\", type text}, {\\"StartOfMonth\\", type date}}),\\n    #\\"Removed Columns\\" = Table.RemoveColumns(#\\"Changed Type\\",{\\"Source.Name\\"}),\\n    #\\"Filtered Rows1\\" = Table.SelectRows(#\\"Removed Columns\\", each [Date] <> null and [Date] <> \\"\\")\\nin\\n    #\\"Filtered Rows1\\""\n  },\n  {\n    "TableName": "ProductDetails",\n    "Expression": "let\\n    Source = #\\"ADLS Base Folder\\",\\n    #\\"Filtered Rows\\" = Table.SelectRows(Source, each Text.Contains([Folder Path], \\"Warehouse.StockItems\\")),\\n    #\\"https://stvnextblobstorage dfs core windows net/fabrikam-sales/Delta-Parquet-Format/Warehouse StockItems/_0-3cb21e23-d47d-472a-bf7c-918c32fbfee6-0 parquet\\" = #\\"Filtered Rows\\"{[#\\"Folder Path\\"=\\"https://stvnextblobstorage.dfs.core.windows.net/fabrikam-sales/Delta-Parquet-Format-FY25/Warehouse.StockItems/\\",Name=\\"0-3cb21e23-d47d-472a-bf7c-918c32fbfee6-0.parquet\\"]}[Content],\\n    #\\"Imported Parquet\\" = Parquet.Document(#\\"https://stvnextblobstorage dfs core windows net/fabrikam-sales/Delta-Parquet-Format/Warehouse StockItems/_0-3cb21e23-d47d-472a-bf7c-918c32fbfee6-0 parquet\\"),\\n  #\\"Changed column type\\" = Table.TransformColumnTypes(#\\"Imported Parquet\\", {{\\"StockItemID\\", Int64.Type}, {\\"StockItemName\\", type text}, {\\"SupplierID\\", Int64.Type}, {\\"ColorID\\", Int64.Type}, {\\"UnitPackageID\\", Int64.Type}, {\\"OuterPackageID\\", Int64.Type}, {\\"Brand\\", type text}, {\\"Size\\", type text}, {\\"LeadTimeDays\\", Int64.Type}, {\\"QuantityPerOuter\\", Int64.Type}, {\\"IsChillerStock\\", type logical}, {\\"Barcode\\", type text}, {\\"TaxRate\\", Int64.Type}, {\\"UnitPrice\\", type number}, {\\"RecommendedRetailPrice\\", type number}, {\\"TypicalWeightPerUnit\\", type number}, {\\"MarketingComments\\", type text}, {\\"SearchDetails\\", type text}, {\\"LastEditedBy\\", Int64.Type}}),\\n    #\\"Removed Other Columns\\" = Table.SelectColumns(#\\"Changed column type\\",{\\"StockItemID\\", \\"CustomFields\\"}),\\n    #\\"Trimmed Text\\" = Table.TransformColumns(#\\"Removed Other Columns\\",{{\\"CustomFields\\", Text.Trim, type text}}),\\n    #\\"Parsed JSON\\" = Table.TransformColumns(#\\"Trimmed Text\\",{{\\"CustomFields\\", Json.Document}}),\\n    #\\"Expanded CustomFields\\" = Table.ExpandRecordColumn(#\\"Parsed JSON\\", \\"CustomFields\\", {\\"CountryOfManufacture\\", \\"Tags\\"}, {\\"CountryOfManufacture\\", \\"Tags\\"}),\\n    #\\"Expanded Tags\\" = Table.ExpandListColumn(#\\"Expanded CustomFields\\", \\"Tags\\"),\\n    #\\"Changed Type\\" = Table.TransformColumnTypes(#\\"Expanded Tags\\",{{\\"Tags\\", type text}, {\\"CountryOfManufacture\\", type text}})\\nin\\n    #\\"Changed Type\\""\n  }\n]'}
```

---

[‚Üê Back to Home](Home.md)
